# 東京都の国基準のコロナデータの csv 化

## URL

https://github.com/sarkov28/c19_tokyo_kunishihyou

## Features

東京都が https://www.fukushihoken.metro.tokyo.lg.jp/iryo/kansen/corona_portal/info/kunishihyou.html で公表している国基準データのうち、2021-07 末以降に waybackmachine（web.archive.org）で入手可能なものの csv 化を試みました。

2021-08-02 時点で、2021-07-06〜2021-08-01 のデータが入手可能でした。

ファイル名が t1 で始まっているファイルは、
- 日付毎にファイル化されています。
- pdf を比較的そのまま csv 化したファイルです。

ファイル名が t2 で始まっているファイルは、
- 全日付のデータを1つのファイルに入れてあります。
- 日付のカラムを追加してあります。

t1 の形式、t2 の形式、どちらにおいても、
- (1a) 各日付において、データ行（＝表頭ではない行）は7行あります。
- (1b) 7行のデータの順序は安定していると思われます。
- (1c) データ行の右2つのカラム（＝実質的なデータカラム）は安定していると思われます。
- (1d) その左2つのカラムは、不安定です。

(1c) に示したように、実質的なデータのカラムは安定していると思われます。

t2 形式のファイルは、プログラム等で処理しやすいことを意図して作成したのですが、フォーマットの揺れがあるので微妙です。

## Note

このデータの作成にあたっては、python を使い、tabula.read_pdf() で DataFrame に変換してから処理しました。

以下の問題がありました。

これらが tabula.read_pdf() を含む処理系の問題なのか、ソースデータの pdf の問題なのかは調べていませんが、(2b) に書いたフォーマットの変化を考えると、ソースデータの問題なのかも知れません。

- (2a) 2021年7月の短い期間の間にも、変換した DataFrame のフォーマットが何度も変化しています。
- (2b) pdf の表示ではデータの入っているカラムが、DataFrame では無くなっている（空欄になっているのではない）ことがあります。（私は読み込んだデータを全て出力しています。ある日に存在したカラムが、別の日に無くなっていることがあります。）

このため、得られた csv は、残念ながらよく注意しながら取り扱う必要があります。

## Plan

東京都は、このリポジトリの元となるデータを、休日も含め、毎日更新しているようです。
https://www.fukushihoken.metro.tokyo.lg.jp/iryo/kansen/corona_portal/info/kunishihyou.html

このリポジトリは、当面の間、週に1度程度は更新しようと思っています。

ただし元となるデータのフォーマットなどに大きな変化があった場合は、追随を諦める可能性があります。

## Author

sarkov28@twitter.com

## License

このリポジトリは、東京都公表の公的データを加工したものです。

自由に使っていただいて構いませんが、フォーマットの揺れがあるため、思わぬ問題が発生している可能性があります。
